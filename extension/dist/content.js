(()=>{var e={150:function(e,s){var t,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(n="function"==typeof(t=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const s="The message port closed before a response was received.",t="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,s){super(s),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const o=(s,t)=>(...n)=>{e.runtime.lastError?s.reject(new Error(e.runtime.lastError.message)):t.singleCallbackArg||n.length<=1&&!1!==t.singleCallbackArg?s.resolve(n[0]):s.resolve(n)},i=e=>1==e?"argument":"arguments",a=(e,s,t)=>new Proxy(s,{apply:(s,n,r)=>t.call(n,e,...r)});let g=Function.call.bind(Object.prototype.hasOwnProperty);const m=(e,s={},t={})=>{let n=Object.create(null),r={has:(s,t)=>t in e||t in n,get(r,l,A){if(l in n)return n[l];if(!(l in e))return;let c=e[l];if("function"==typeof c)if("function"==typeof s[l])c=a(e,e[l],s[l]);else if(g(t,l)){let s=((e,s)=>function(t,...n){if(n.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${i(s.minArgs)} for ${e}(), got ${n.length}`);if(n.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${i(s.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((r,i)=>{if(s.fallbackToNoCallback)try{t[e](...n,o({resolve:r,reject:i},s))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),t[e](...n),s.fallbackToNoCallback=!1,s.noCallback=!0,r()}else s.noCallback?(t[e](...n),r()):t[e](...n,o({resolve:r,reject:i},s))}))})(l,t[l]);c=a(e,e[l],s)}else c=c.bind(e);else if("object"==typeof c&&null!==c&&(g(s,l)||g(t,l)))c=m(c,s[l],t[l]);else{if(!g(t,"*"))return Object.defineProperty(n,l,{configurable:!0,enumerable:!0,get:()=>e[l],set(s){e[l]=s}}),c;c=m(c,s[l],t["*"])}return n[l]=c,c},set:(s,t,r,o)=>(t in n?n[t]=r:e[t]=r,!0),defineProperty:(e,s,t)=>Reflect.defineProperty(n,s,t),deleteProperty:(e,s)=>Reflect.deleteProperty(n,s)},l=Object.create(e);return new Proxy(l,r)},l=e=>({addListener(s,t,...n){s.addListener(e.get(t),...n)},hasListener:(s,t)=>s.hasListener(e.get(t)),removeListener(s,t){s.removeListener(e.get(t))}}),A=new r((e=>"function"!=typeof e?e:function(s){const t=m(s,{},{getContent:{minArgs:0,maxArgs:0}});e(t)}));let c=!1;const u=new r((e=>"function"!=typeof e?e:function(s,n,r){let o,i,a=!1,g=new Promise((e=>{o=function(s){c||(console.warn(t,(new Error).stack),c=!0),a=!0,e(s)}}));try{i=e(s,n,o)}catch(e){i=Promise.reject(e)}const m=!0!==i&&((l=i)&&"object"==typeof l&&"function"==typeof l.then);var l;if(!0!==i&&!m&&!a)return!1;return(m?i:g).then((e=>{r(e)}),(e=>{let s;s=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:s})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),d=({reject:t,resolve:n},r)=>{e.runtime.lastError?e.runtime.lastError.message===s?n():t(new Error(e.runtime.lastError.message)):r&&r.__mozWebExtensionPolyfillReject__?t(new Error(r.message)):n(r)},x=(e,s,t,...n)=>{if(n.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${i(s.minArgs)} for ${e}(), got ${n.length}`);if(n.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${i(s.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,s)=>{const r=d.bind(null,{resolve:e,reject:s});n.push(r),t.sendMessage(...n)}))},p={devtools:{network:{onRequestFinished:l(A)}},runtime:{onMessage:l(u),onMessageExternal:l(u),sendMessage:x.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:x.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},h={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":h},services:{"*":h},websites:{"*":h}},m(e,p,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=browser})?t.apply(s,[e]):t)||(e.exports=n)}},s={};function t(n){var r=s[n];if(void 0!==r)return r.exports;var o=s[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}(()=>{"use strict";const e=[{name:"LinkedIn",match:"/linkedin",url:"https://www.linkedin.com/",cookies:[{name:"li_at",domain:".www.linkedin.com"}]}];var s=t(150),n=t(150);const r=[class{_fastPoll=100;_spinnerDelay=1e3;_fieldInfosLength=2;_hostRegex=RegExp("localhost");_pathnameRegex=RegExp("/static/index.html");_interval;_stepSetupSessionCookieDivSelector='div[id^="formField-sessionCookie"]';_stepSetupSessionCookieInnerDivSelector="div";_stepSetupSessionCookieInputSelector="input";_getCookieButtonClass="pbExtensionNewSetupCookieButton";_phantomNameSelector1="header p";_phantomNameSelector2="aside header span";_phantomName="";_foundWebsites={};sendMessage=async e=>{console.log("handler.ts Message sent",e);try{await s.runtime.sendMessage(e)}catch(t){try{s.runtime.connect().postMessage(e)}catch(s){console.log(s),console.error("Could not send message",e)}}};detect=()=>(console.log("SETUP detect"),this._hostRegex.test(window.location.host)&&this._pathnameRegex.test(window.location.pathname));onMessage=e=>{console.log("*** phantombusterNewSetup *** onMessage"),e.cookies&&this._onMessageCookies(e.cookies.websiteName,e.cookies.cookies,e.cookies.newSession)};run=async()=>{console.log("SETUP run"),this._interval=setInterval(this._findStepSetupFieldSessionCookies,this._fastPoll)};destroy=()=>{console.log("SETUP destroy"),this._interval&&clearInterval(this._interval);const e=Array.from(document.querySelectorAll<HTMLButtonElement>`.${this._getCookieButtonClass}`);for(const s of e)s.remove();document.removeEventListener("keydown",this._keydownListener),document.removeEventListener("keyup",this._keyupListener)};_onMessageCookies=(e,s,t=!1)=>{console.log("*** phantombusterNewSetup *** _onMessageCookies");const n=this._foundWebsites[e];n&&(0!==s.length&&s[0]?this._fillInputs(n,s):this._websiteLogin(n,t))};_websiteLogin=(e,s=!1)=>{console.log("SETUP _websiteLogin"),e.login=!0;for(const s of e.elements)s.btn.textContent=`Please log in to ${e.website.name}`;this.sendMessage({notif:{message:`Please log in to ${e.website.name}`}}),this.sendMessage({newTab:{websiteName:e.website.name,url:e.website.url,newSession:s}})};_onInputChange=e=>{console.log("SETUP _onInputChange");for(const s of e)s.btn.disabled=!1,s.btn.textContent=s.btn.getAttribute("textContentConnect")};_fillInputs=async(e,s)=>{console.log("SETUP _fillInputs"),e.login&&(await new Promise((e=>setTimeout(e,this._spinnerDelay))),e.login=!1);for(const t in s)s[t]&&e.elements[t]&&(e.elements[t].btn.textContent=`Connected to ${e.website.name}`,e.elements[t].btn.classList.remove("pr-10"),e.elements[t].btn.disabled=!0,e.elements[t].input.value=s[t].value,e.elements[t].inputListener&&e.elements[t].input.removeEventListener("input",e.elements[t].inputListener),e.elements[t].input.dispatchEvent(new Event("input",{bubbles:!0})),e.elements[t].inputListener||(e.elements[t].inputListener=()=>{this._onInputChange(e.elements)}),e.elements[t].input.addEventListener("input",e.elements[t].inputListener));this.sendMessage({notif:{message:`${this._phantomName} is now connected to ${e.website.name}`}})};_createGetCookieBtn(e){console.log("SETUP _createGetCookieBtn",e);const s=document.createElement("button");return s.className=`${this._getCookieButtonClass} btn br-4 bg-dark-blue text-nowrap relative f5 mx-1 my-1`,s.type="button",s.setAttribute("analyticsid","agentSetupStepsInputGetcookieBtn"),s.setAttribute("analyticsval1",e.name),s.setAttribute("textContentConnect",`Connect to ${e.name}`),s.setAttribute("textContentLogin",`Connect to ${e.name} (new session)`),s.textContent=s.getAttribute("textContentConnect"),"true"===document.querySelector("body > #root > div")?.dataset.loggedAs?s.disabled=!0:(s.onclick=s=>{this.sendMessage({getCookies:{websiteName:e.name,newSession:s.shiftKey}})},s.onmouseover=e=>{e.target instanceof HTMLButtonElement&&(e.target.setAttribute("hover","true"),!0===e.shiftKey&&(e.target.textContent=e.target.getAttribute("textContentLogin")))},s.onmouseout=e=>{e.target instanceof HTMLButtonElement&&(e.target.removeAttribute("hover"),e.target.textContent=e.target.getAttribute("textContentConnect"))}),s}_handleStepSetupFieldDiv=s=>{console.log("SETUP _handleStepSetupFieldDiv");const t=s&&s.querySelector(this._stepSetupSessionCookieInnerDivSelector),n=s&&s.querySelector(this._stepSetupSessionCookieInputSelector),r=s.dataset&&s.dataset.fieldInfo&&s.dataset.fieldInfo.split("/");if(t&&n&&r&&r.length===this._fieldInfosLength){const o=r[0],i=r[1],a=(s=>{const t=e.filter((e=>e.name===s));return 1===t.length?t[0]:null})(o);if(!a)return;const g={cookieName:i,div:s,innerDiv:t,input:n,btn:this._createGetCookieBtn(a)};this._foundWebsites[a.name]?this._foundWebsites[a.name]&&this._foundWebsites[a.name].elements.push(g):this._foundWebsites[a.name]={website:a,login:!1,elements:[g]}}};_setPhantomName=()=>{console.log("SETUP _setPhantomName");let e=document.querySelector(this._phantomNameSelector1).textContent;e&&"Setup"!==e.trim()||(e=document.querySelector(this._phantomNameSelector2).textContent),this._phantomName=e||""};_keydownListener=e=>{if(console.log("SETUP _keydownListener"),"Shift"===e.key){const e=Array.from(document.querySelectorAll<HTMLButtonElement>`.${this._getCookieButtonClass}`);for(const s of e)s.hasAttribute("hover")&&(s.textContent=s.getAttribute("textContentLogin"))}};_keyupListener=e=>{if(console.log("SETUP _keyupListener"),"Shift"===e.key){const e=Array.from(document.querySelectorAll<HTMLButtonElement>`.${this._getCookieButtonClass}`);for(const s of e)s.hasAttribute("hover")&&(s.textContent=s.getAttribute("textContentConnect"))}};_findStepSetupFieldSessionCookies=()=>{console.log("SETUP _findStepSetupFieldSessionCookies"),console.log(document.querySelectorAll(this._stepSetupSessionCookieDivSelector));const e=Array.from(document.querySelectorAll(this._stepSetupSessionCookieDivSelector));if(this._interval&&e.length){clearInterval(this._interval);for(const s of e)this._handleStepSetupFieldDiv(s);this._setPhantomName();for(const e of Object.values(this._foundWebsites))if(e){for(const s of e.elements)s.innerDiv.appendChild(s.btn);document.addEventListener("keydown",this._keydownListener),document.addEventListener("keyup",this._keyupListener)}}}}];!async function e(){console.log("main called in content.js"),console.log("main",r);const s=[];console.log("LOOPING OVER handlers");for(const e of r){const t=new e;t.detect()&&s.push(t)}console.log("CALLING runtimeMessagesListener",s),(s=>{console.log("runtimeMessagesListener");const t=r=>{if(console.log("BACKGROUND LISTENER"),console.log("Message received",r),r.restart){n.runtime.onMessage.removeListener(t),console.log("browser.runtime.onMessage.removeListener(backgroundListener)");for(const e of s)e.destroy();return e()}for(const e of s)e.onMessage(r)};n.runtime.onMessage.addListener(t)})(s);for(const e of s)e.destroy(),e.run().catch((e=>console.error(e)))}()})()})();